    <!--template for new event iron-localstorage-->
<dom-module id="create-event">
  <template>
    <iron-localstorage
      name="thing"
      value="{{thing}}"
      on-iron-localstorage-load="eventLoaded"
      on-iron-localstorage-load-empty="initializeEvent"
      id="eventStore">
    </iron-localstorage>

        <!-- event name -->
    <paper-input type="text" label="What do you want to call the event?" value="{{thing.eventName::change}}" required auto-validate autocomplete="on" error-message="Name of the event, please"  id="eventName"  class="thingRequired"></paper-input>
    <!-- event type -->
    <paper-autocomplete type="text" label="What kind of event? Wedding..."  required error-message="Event type?" id="input-local" class="thingRequired"></paper-autocomplete>
    <!-- event host -->
    <paper-input type="text" label="Who is hosting the event?" required auto-validate autocomplete="on" error-message="host for the event?" id="hostName" value="{{thing.hostName::change}}" class="thingRequired"></paper-input>
    <!-- event start -->
    <paper-input type="datetime-local" label ="start date and time" required auto-validate error-message="When does it start?" id="start" class="thingRequired"></paper-input>
    <!-- event end -->
    <paper-input type="datetime-local" label ="end date and time" required auto-validate error-message="When does it end?" id="end" class="thingRequired"></paper-input>
    <!-- event guests -->
    <paper-input type="text" label="Who do you want to invite?" required auto-validate autocomplete="on" error-message="Guests?" id="guestList" value="{{thing.guests::change}}" class="thingRequired"></paper-input>
    <!-- event adress -->
    <paper-input type="text" id="address" label="Address" onFocus="geolocate()" required auto-validate autocomplete="on" error-message="Where is it?" id="place" value="{{thing.address::change}}" class="thingRequired"></paper-input>
    <!-- event mesasge -->
    <paper-input type="text" label="Additional information to the guests?" id="addInfo"></paper-input>

    <paper-button raised on-click="createEventBtn" id="createEventBtn">create event</paper-button>
    <br>
    <br>
    <p id="eventValue"></p>

  </template>
</dom-module>

<script type="text/javascript">

      // a polymer script for localstorage
  Polymer({
    is: 'create-event',
    properties: {
      thing: {
        type: Object,
        notify: true
      }
    },
    // initializes default if nothing has been stored
    initializeEvent: function() {
      var fullName = document.getElementById('firstName').value + " " + document.getElementById('lastName').value;
        this.thing = {
          eventName: "",
          eventType: "",
          hostName: fullName,
          startTime: "",
          endTime: "",
          guests: "",
          address: "",
          addInfo: ""
        }
    },
    // when the event is loaded
   eventLoaded: function() {
      console.log('thing loaded; value: '+ this.thing.hostName + " " + this.thing.eventName);
      var fullName = document.getElementById('firstName').value + " " + document.getElementById('lastName').value;
    },

  // when the create event button is clicked all the required fields should be filled in and
  //the user input is saved in an array
  createEventBtn: function() {

    var guests = document.getElementById('guestList');
    var eventName = document.getElementById('eventName');
    var eventType = document.getElementById('input-local');
    var eventHost = document.getElementById('hostName');
    var eventStart = document.getElementById('start');
    var eventEnd = document.getElementById('end');
    var eventAdress = document.getElementById('address');
    var eventInfo = document.getElementById('addInfo');

    var valid = validateForm(); //checks that all required fields are filled in

    if (valid) {
        this.$.eventValue.innerHTML = this.$.eventStore.value.eventName + " has been created";

        // to get the string values of the inputs
        this.thing.startTime = eventStart.value;
        this.thing.endTime = eventEnd.value;
        this.thing.eventType = eventType.value;

        createEventArray.push(this.thing)
        showEventFunction();

      } else {
        this.$.eventValue.innerHTML = "Please check that you filled in all required fields";
      }
    }

  });


  function validateForm() {
    var isValid = true;
    $('.thingRequired').each(function() {
      if ( $(this).val() === '' )
          isValid = false;
    });
    return isValid;
  };

   // localStorage can only handle strings with thess two new prototypes we can use it for objects and arrays as well
  // Use localStorage.setObj(key, value) to save an array or object and localStorage.getObj(key) to retrieve it.
  Storage.prototype.setObj = function(key, obj) { //
    return this.setItem(key, JSON.stringify(obj))
  }

  Storage.prototype.getObj = function(key) {
      return JSON.parse(this.getItem(key))
  }

  // an event array to save the different events
  var createEventArray = [];

  function showEventFunction() {
    // saving old eventsfrom localStorage into createEventArray to be able to show them
    var oldEvents = localStorage.getObj("events")
    console.log(oldEvents)

    oldEvents.forEach(function(ev) {
      createEventArray.push(ev)
    });

    // saving all events (old and new) in localStorage
    localStorage.setObj("events", createEventArray);


    // To show the created events array in show event
      var ev = document.getElementById("events"); //div for each event
      var evName = document.getElementById("evName"); //name of the event
      var ev1 = document.getElementById("show"); //p element general info
      var ev2 = document.getElementById("showTime"); //p element showing time
      var ev3 = document.getElementById("showLocation"); //p element showing location
      var ev4 = document.getElementById("showAddInfo"); //p element show addition info

      var events = localStorage.getObj("events");
      console.log(localStorage.getObj("events")[0]);
      console.log(localStorage.getObj("events")[0].eventName);



      evName.textContent = events[0].eventName;
      ev1.textContent = events[0].hostName + " invited " + events[0].guests + " to " + events[0].eventType + "." ;
      ev2.textContent = "Starting: " + events[0].startTime + " and ending: " + events[0].endTime + "." ;
      ev3.textContent = " Address: " + events[0].address + ".";
      ev4.textContent = events[0].addInfo;

      events.forEach(function(ev) {
        append
      })

  }


</script>