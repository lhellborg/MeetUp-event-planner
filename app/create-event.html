    <!--template for new event iron-localstorage-->
<dom-module id="create-event">
  <template>
    <iron-localstorage
      name="thing"
      value="{{thing}}"
      on-iron-localstorage-load="eventLoaded"
      on-iron-localstorage-load-empty="initializeEvent"
      id="eventStore">
    </iron-localstorage>

        <!-- event name -->
    <paper-input type="text" label="What do you want to call the event?"  required auto-validate autocomplete="on" error-message="Name of the event, please"  id="eventName"  class="thingRequired"></paper-input>
    <!-- event type -->
    <paper-autocomplete type="text" label="What kind of event? Wedding..."  required auto-validate autocomplete="on" error-message="Event type?" id="input-local" class="thingRequired"></paper-autocomplete>
    <!-- event host -->
    <paper-input type="text" label="Who is hosting the event?" required auto-validate autocomplete="on" error-message="host for the event?" id="hostName" value="{{thing.hostName::change}}" class="thingRequired"></paper-input>
    <!-- event adress -->
    <paper-input id="place" label="Address" error-message="Where is it?" required auto-validate autocomplete="on" error-message="Where is it?" class="thingRequired"></paper-input>
    <!-- event start -->
    <paper-input type="datetime-local" label ="start date and time" required auto-validate error-message="When does it start?" id="start" class="thingRequired date"></paper-input>
    <!-- event end -->
    <paper-input type="datetime-local" label ="end date and time" required auto-validate error-message="When does it end?" id="end" class="thingRequired date"></paper-input>
    <!-- event guests -->
    <paper-input type="text" label="Who do you want to invite?" required auto-validate autocomplete="on" error-message="Guests?" id="guestList" class="thingRequired"></paper-input>

    <!-- event mesasge -->
    <paper-input type="text" label="Additional information to the guests?" id="addInfo"></paper-input>

    <br>
    <paper-button raised on-click="createEventBtn" id="createEventBtn">create event</paper-button>
    <br>
    <br>
    <p id="eventValue"></p>

  </template>
</dom-module>

<script type="text/javascript">

      // a polymer script for localstorage
  Polymer({
    is: 'create-event',
    properties: {
      thing: {
        type: Object,
        notify: true
      }
    },
    // initializes default if nothing has been stored
    initializeEvent: function() {
      var fullName = document.getElementById('firstName').value + " " + document.getElementById('lastName').value;
        this.thing = {
          eventName: "",
          eventType: "",
          hostName: fullName,
          startTime: "",
          endTime: "",
          guests: "",
          address: "",
          addInfo: ""
        }
    },
    // when the event is loaded
   eventLoaded: function() {
      console.log('thing loaded; value: '+ this.thing.hostName + " " + this.thing.eventName);
      var fullName = document.getElementById('firstName').value + " " + document.getElementById('lastName').value;
      this.thing.hostName = fullName;
    },

  // when the create event button is clicked all the required fields should be filled in and
  //the user input is saved in an array
  createEventBtn: function() {

    var guests = document.getElementById('guestList');
    var eventName = document.getElementById('eventName');
    var eventType = document.getElementById('input-local');
    var eventHost = document.getElementById('hostName');
    var eventStart = document.getElementById('start');
    var eventEnd = document.getElementById('end');
    var eventAdress = document.getElementById('place');
    var eventInfo = document.getElementById('addInfo');

    var valid = validateCreateEvent(); //checks that all required fields are filled in

    if (valid) {
        this.$.eventValue.innerHTML = this.$.eventStore.value.eventName + " has been created";

        // to get the string values of the inputs
        this.thing.startTime = eventStart.value;
        this.thing.endTime = eventEnd.value;
        this.thing.eventType = eventType.value;
        this.thing.address = eventAdress.value;

        createEventArray.push(this.thing) //add event info to the array
        storeEvents(); //store the information in localStorage


      } else {
        this.$.eventValue.innerHTML = "Please check that you filled in all required fields";
      }
    }

  });


  function validateCreateEvent() {
    var isValid = true;
    $('.thingRequired').each(function() {
      if ( $(this).val() === '' )
          isValid = false;
    });
    return isValid;
  };

   // localStorage can only handle strings with thess two new prototypes we can use it for objects and arrays as well
  // Use localStorage.setObj(key, value) to save an array or object and localStorage.getObj(key) to retrieve it.
  Storage.prototype.setObj = function(key, obj) { //
    return this.setItem(key, JSON.stringify(obj))
  }

  Storage.prototype.getObj = function(key) {
      return JSON.parse(this.getItem(key))
  }

  // an event array to save the different events
  var createEventArray = [];

  function storeEvents() {

    // saving old eventsfrom localStorage into createEventArray to be able to show them
    var oldEvents = localStorage.getObj("events")

    if (oldEvents != null) {
      oldEvents.forEach(function(ev) {
        createEventArray.push(ev)
      });

    }
      // saving all events (old and new) in localStorage
      localStorage.setObj("events", createEventArray);
    }

  function showEventFunction() {
     // remove the elements in the show event section before adding new ones
    $("#events").empty();

    var events = localStorage.getObj("events");

    if (events != null) {
      events.forEach(function(ev) {
        $("#events").append('<div class="event-entry"><h5 class="showEventName">' + ev.eventName + "</h5>" +
        '<div class="showDetails"><p>' + ev.hostName + " invited " + ev.guests + " to " + ev.eventType + "." + "</p>" +
              '<p> ' + "Starting: " + ev.startTime + " and ending: " + ev.endTime + "." + "</p>" +
              '<p>' + " Address: " + ev.address + "." + "</p>" +
              '<p>' + ev.addInfo + "</p></div></div>");
      }) //end forEach
    } else {
      $("#events").append('<div><h5>' + "There are no saved events to show" + "</h5>");
    }
  } //end showEventFunction

  function showLastEvent() {
    // remove the elements in the show event section before adding new ones
    $("#events").empty();

    var ev = localStorage.getObj("events");

    if (ev != null) {
      $("#events").append('<div class="event-entry"><h5 class="showEventName">' + ev[0].eventName + "</h5>" +
      '<div><p>' + ev[0].hostName + " invited " + ev[0].guests + " to " + ev[0].eventType + "." + "</p>" +
      '<p> ' + "Starting: " + ev[0].startTime + " and ending: " + ev[0].endTime + "." + "</p>" +
      '<p>' + " Address: " + ev[0].address + "." + "</p>" +
      '<p>' + ev[0].addInfo + "</p></div></div>");
    } else {
      $("#events").append('<div><h5>' + "There are no saved events to show" + "</h5>");
    }


  } //end showLastEvent


</script>












